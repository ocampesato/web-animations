<link rel="import" href="bower_components/polymer/polymer.html">

<polymer-element name="svg-graphics" attributes="width height">
 <template>
   <style>
     :host { display:block; }
     .slice { } 
   </style>

   <svg id="svg" width="{{width}}" height="{{height}}"> 
      <template repeat="{{shape in shapes}}">
        <rect id="{{'e'+shapeIndex}}" x="{{shape.x}}" y="{{shape.y}}" 
              width="{{shape.rw}}" height="{{shape.rh}}" 
              transform="{{shape.tr}}"
              style="fill:{{shape.fill}}" on-mouseover="{{updateGraphics}}"/>
      </template>
    </svg>
  </template>

  <script>
     (function() {
     //var colors=["#FF0000","#0000FF","#FF00FF","#FF0000"];
     //var mainColors = ["#1f77b4", "#aec7e8", "#ff7f0e"];
       var mainColors = ["#f00", "#ff0", "#00f"];

       Polymer('svg-graphics',{
         updateGraphics: function(e){
            e.currentTarget.style="fill: blue;";
            e.currentTarget.attributes.y.value = "200";
         },
         colors : null,
         shapes : null,
         observe : {
           width : 'render'
         },
         getShapes : function() {
           var basePointX  = 250, basePointY = 250;
           var currentX    = 0, currentY     = 0;
           var offsetX     = 0, offsetY      = 0;
           var radius      = 0, spiralCount  = 4;
           var Constant    = 200, angle     = 0;
           var deltaAngle  = 1, maxAngle     = 721;
           var radius      = 0, sine         = 0;
           var cosine      = 0, factor       = 1;
         
           var offsetX=0, offsetY=0, index=0;
           var rectWidth=40, rectHeight=60; 
           var shapes=[], color="";
           var colors=["#FF0000","#0000FF","#FF00FF","#FF0000"];
         
           for(angle=0; angle<maxAngle; angle+=deltaAngle) {
             sine     = Math.sin(factor*angle*Math.PI/180);
             cosine   = Math.cos(factor*angle*Math.PI/180);
             if(cosine == 0) {
               radius = 10;
             } else {
               radius   = Constant*sine*sine/cosine;
             } 
 
             offsetX  = radius*Math.cos(angle*Math.PI/180);
             offsetY  = radius*Math.sin(angle*Math.PI/180);
             currentX = basePointX+offsetX;
             currentY = basePointY-offsetY;
         
             // an index into the array of colors
             index = Math.floor(angle/deltaAngle);
         
             var transform = "skewY("+(-angle%50)+")";

             // append an (x,y) pair of values that
             // represent the upper-left vertex 
             shapes.push({x:currentX,   y:currentY, 
                          rw:rectWidth, rh:rectHeight,
                          tr:transform, fill:colors[index%colors.length]});
           }

           return shapes;
         },
         render : function() {
           this.shapes = this.getShapes();
         }
     })
   })();
  </script>

